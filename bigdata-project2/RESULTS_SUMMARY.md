# MapReduce实验结果汇总

## 实验完成情况 ✅

### 任务一：商家优惠券使用情况统计
- **数据规模**: 8018个商家
- **结果文件**: `output/task1/result.txt`
- **可视化**: `output/task1_visualization.png`
- **关键发现**:
  - 商家1004: 负样本82, 普通消费281, 正样本1 (低转化率)
  - 商家1011: 负样本63, 普通消费59, 正样本6 (平衡型)
  - 商家1018: 负样本4, 普通消费6, 正样本5 (高转化率)

### 任务二：商家距离统计
- **数据规模**: 8018个商家的距离分布
- **结果文件**: `logs/task2_result.txt`
- **可视化**: `output/task2_visualization.png`
- **关键发现**:
  - 距离0(同城)的用户最活跃
  - 部分商家覆盖多个距离级别(0-10公里)
  - null距离也有大量消费行为

### 任务三：优惠券使用间隔统计
- **数据规模**: 5462个优惠券
- **结果文件**: `logs/task3_result.txt`
- **可视化**: `output/task3_visualization.png`
- **关键发现**:
  - 平均间隔: ~7天
  - 中位数间隔: ~4天
  - 很多优惠券当天使用(间隔0天)
  - 最长间隔可达30天以上

### 任务四：影响因素分析

#### 4.1 折扣率对核销率的影响
- **结果文件**: `logs/task4_discount_result.txt`
- **数据发现**:
  ```
  超大折扣(<50%)      76张    3张使用     3.95%
  大折扣(50%-70%)     29,950   2,668      8.91%
  中等折扣(70%-85%)   272,070  24,330     8.94%
  小折扣(85%-95%)     268,686  9,791      3.64%
  极小折扣(95%-100%)  59,042   8,174      13.84%
  ```
- **关键洞察**:
  - 极小折扣(95%-100%)核销率最高: 13.84%
  - 小折扣(85%-95%)核销率最低: 3.64%
  - 中等和大折扣核销率相似: ~8.9%
  - **结论**: 低门槛券更易使用，高门槛但优惠小的券最不受欢迎

#### 4.2 用户活跃度对核销率的影响
- **结果文件**: `logs/task4_user_result.txt`
- **数据发现**:
  ```
  中频用户(20-49券)   5,982    2,138     35.74%
  低频用户(10-19券)   46,023   6,246     13.57%
  偶尔用户(1-9券)     576,921  35,986    6.24%
  高频用户(>=50券)    898      596       66.37%
  ```
- **关键洞察**:
  - 高频用户核销率最高: 66.37% (最有价值用户)
  - 中频用户核销率次之: 35.74% (核心目标群体)
  - 偶尔用户核销率最低: 6.24% (可能是"羊毛党")
  - **结论**: 用户活跃度与核销率呈正相关

## 技术实现亮点

1. **兼容性处理**: 修复Python 3.5不支持f-string的问题
2. **本地模式运行**: 使用Hadoop本地模式成功处理43MB数据
3. **数据去重**: Task2使用set()实现用户去重统计
4. **两阶段MapReduce**: Task4-2实现复杂的用户分析逻辑
5. **数据可视化**: 生成4张高质量图表展示分析结果

## 实验成果
- ✅ 4个MapReduce任务全部完成
- ✅ 处理数据量: 75万+记录
- ✅ 生成可视化图表: 4张
- ✅ 实验报告: 已完成

---
**实验完成时间**: 2025年10月27日
